<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arrivals | Miki &amp; Yi Jie</title>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="/styles.css" />
    <style>
      html,
      body {
        margin: 0;
        min-height: 100%;
        background: var(--maroon) !important;
      }
      .arrivals-shell {
        min-height: 100vh;
        background: var(--maroon);
      }
      .arrivals-shell__main {
        width: 100%;
        max-width: none;
        margin: 0;
        padding-top: calc(var(--headerH) + 24px);
      }
      .arrivals-shell__frame {
        border: 0;
        border-radius: 22px;
        overflow: hidden;
        box-shadow: none;
      }
      .arrivals-shell__iframe {
        display: block;
        width: 100%;
        height: auto;
        min-height: 900px;
        border: 0;
        background: #090807;
        overflow: visible;
      }
      @media (max-width: 900px) {
        .arrivals-shell__main {
          padding-top: calc(var(--headerH) + 16px);
        }
        .arrivals-shell__iframe {
          min-height: 780px;
        }
      }
    </style>
  </head>
  <body class="arrivals-shell">
    <header id="floatingHeader" class="floating-header" aria-label="Site navigation">
      <div class="header-pill">
        <a class="brand" href="/" aria-label="Go to home page">
          <span class="brand-pill" aria-hidden="true">
            <span class="brand-wordmark" aria-hidden="true">
              <span class="brand-wordmark-core">M</span><span class="brand-wordmark-rest brand-wordmark-rest--m">iki</span>
              <span class="brand-wordmark-amp amp-fancy">&amp;</span>
              <span class="brand-wordmark-core">Y</span><span class="brand-wordmark-rest brand-wordmark-rest--y">i Jie</span>
            </span>
          </span>
          <span class="sr-only">Miki &amp; Yi Jie</span>
        </a>

        <button id="menuToggle" class="menu-toggle" aria-expanded="false" aria-controls="mobileNavSheet" aria-label="Open menu">â˜°</button>

        <nav class="desktop-nav" aria-label="Primary">
          <a href="/">Home</a>
          <a href="/#story">Our story</a>
          <a href="/#venue">Venue</a>
          <a href="/#schedule">Schedule</a>
          <div id="desktopNavMore" class="desktop-nav-more">
            <button
              id="desktopMoreToggle"
              class="desktop-nav-more-toggle"
              type="button"
              aria-haspopup="menu"
              aria-expanded="false"
              aria-controls="desktopMoreMenu"
            >
              More
            </button>
            <div id="desktopMoreMenu" class="desktop-nav-more-menu" role="menu" hidden>
              <a href="/#faq" role="menuitem">FAQ</a>
              <a href="/#stay" role="menuitem">Where to stay</a>
              <a href="/#things-to-do" role="menuitem">Things to do</a>
              <a href="/#makan" role="menuitem">What to eat</a>
              <a href="/#travel-visa" role="menuitem">Travel &amp; Visa</a>
              <a href="/#gallery" role="menuitem">Recent moments</a>
              <a href="/arrivals/" role="menuitem" class="nav-live-link"
                >Live Arrivals
                <span class="live-pill" aria-hidden="true"><span class="live-dot"></span>Live</span>
              </a>
              <a href="/guest-wall" role="menuitem">Guest Wall</a>
            </div>
          </div>
        </nav>

        <a class="header-rsvp" href="/#rsvp">RSVP</a>
      </div>
    </header>

    <aside id="mobileNavSheet" class="mobile-sheet" aria-label="Mobile menu">
      <nav class="mobile-nav">
        <a href="/">Home</a>
        <a href="/#story">Our story</a>
        <a href="/#venue">Venue</a>
        <a href="/#schedule">Schedule</a>
        <a href="/#rsvp">RSVP</a>
        <a href="/#faq">FAQ</a>
        <a href="/#stay">Where to stay</a>
        <a href="/#things-to-do">Things to do</a>
        <a href="/#makan">What to eat</a>
        <a href="/#travel-visa">Travel &amp; Visa</a>
        <a href="/#gallery">Recent moments</a>
        <a href="/arrivals/" class="nav-live-link"
          >Live Arrivals
          <span class="live-pill" aria-hidden="true"><span class="live-dot"></span>Live</span>
        </a>
        <a href="/guest-wall">Guest Wall</a>
      </nav>
    </aside>

    <main class="arrivals-shell__main">
      <section class="arrivals-shell__frame" aria-label="Live Arrivals Tracker">
        <iframe
          id="arrivalsTrackerFrame"
          class="arrivals-shell__iframe"
          src="/public/arrivals/index.html"
          title="Arrivals Tracker"
          scrolling="no"
        ></iframe>
      </section>
    </main>
    <script>
      (() => {
        const menuToggle = document.getElementById("menuToggle");
        const mobileNavSheet = document.getElementById("mobileNavSheet");
        const desktopMoreToggle = document.getElementById("desktopMoreToggle");
        const desktopMoreMenu = document.getElementById("desktopMoreMenu");

        const closeDesktopMoreMenu = () => {
          if (!desktopMoreToggle || !desktopMoreMenu) return;
          desktopMoreToggle.setAttribute("aria-expanded", "false");
          desktopMoreMenu.hidden = true;
        };

        const openDesktopMoreMenu = () => {
          if (!desktopMoreToggle || !desktopMoreMenu) return;
          desktopMoreToggle.setAttribute("aria-expanded", "true");
          desktopMoreMenu.hidden = false;
        };

        const closeMobileMenu = () => {
          if (!menuToggle || !mobileNavSheet) return;
          menuToggle.setAttribute("aria-expanded", "false");
          mobileNavSheet.classList.remove("open");
        };

        if (menuToggle && mobileNavSheet) {
          menuToggle.addEventListener("click", () => {
            const isOpen = menuToggle.getAttribute("aria-expanded") === "true";
            menuToggle.setAttribute("aria-expanded", isOpen ? "false" : "true");
            mobileNavSheet.classList.toggle("open", !isOpen);
          });

          document.addEventListener("click", (event) => {
            const target = event.target;
            if (!(target instanceof Element)) return;
            if (target.closest("#menuToggle") || target.closest("#mobileNavSheet")) return;
            closeMobileMenu();
          });

          document.addEventListener("keydown", (event) => {
            if (event.key === "Escape") closeMobileMenu();
          });

          mobileNavSheet.querySelectorAll("a").forEach((link) => {
            link.addEventListener("click", closeMobileMenu);
          });
        }

        if (desktopMoreToggle && desktopMoreMenu) {
          desktopMoreToggle.addEventListener("click", () => {
            const isOpen = desktopMoreToggle.getAttribute("aria-expanded") === "true";
            if (isOpen) {
              closeDesktopMoreMenu();
            } else {
              openDesktopMoreMenu();
            }
          });

          desktopMoreMenu.querySelectorAll("a").forEach((link) => {
            link.addEventListener("click", closeDesktopMoreMenu);
          });
        }

        const handleGlobalClose = (event) => {
          const target = event.target;
          if (!(target instanceof Element)) return;
          if (target.closest("#menuToggle") || target.closest("#mobileNavSheet")) return;
          if (target.closest("#desktopMoreToggle") || target.closest("#desktopMoreMenu")) return;
          closeMobileMenu();
          closeDesktopMoreMenu();
        };

        document.addEventListener("click", handleGlobalClose);

        document.addEventListener("keydown", (event) => {
          if (event.key !== "Escape") return;
          closeMobileMenu();
          closeDesktopMoreMenu();
        });

        const iframe = document.getElementById("arrivalsTrackerFrame");
        if (!iframe) return;

        let frameResizeObserver = null;
        let frameMutationObserver = null;

        const setFrameHeight = () => {
          const doc = iframe.contentDocument;
          if (!doc) return;

          const rootHeight = doc.documentElement ? doc.documentElement.scrollHeight : 0;
          const bodyHeight = doc.body ? doc.body.scrollHeight : 0;
          const nextHeight = Math.max(900, Math.ceil(Math.max(rootHeight, bodyHeight)));

          iframe.style.height = `${nextHeight}px`;
        };

        const scheduleFrameHeight = () => {
          window.requestAnimationFrame(setFrameHeight);
        };

        iframe.addEventListener("load", () => {
          setFrameHeight();
          const doc = iframe.contentDocument;
          if (!doc) return;

          if (frameResizeObserver) frameResizeObserver.disconnect();
          if (frameMutationObserver) frameMutationObserver.disconnect();

          if ("ResizeObserver" in window) {
            frameResizeObserver = new ResizeObserver(scheduleFrameHeight);
            frameResizeObserver.observe(doc.documentElement);
            if (doc.body) frameResizeObserver.observe(doc.body);
          }

          frameMutationObserver = new MutationObserver(scheduleFrameHeight);
          frameMutationObserver.observe(doc.documentElement, {
            childList: true,
            subtree: true,
            attributes: true,
            characterData: false,
          });

          window.setTimeout(setFrameHeight, 80);
          window.setTimeout(setFrameHeight, 320);
        });

        window.addEventListener("resize", scheduleFrameHeight);
      })();
    </script>
  </body>
</html>
